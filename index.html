<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Saeedi Course Marketplace</title>

  <style>
    :root{
      --primary:#4f46e5;
      --muted:#6b7280;
      --card:#ffffff;
      --bg:#f6f6f8;
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Inter,system-ui;
      color:#111827;background:var(--bg);
    }

    header{
      background:white;border-bottom:1px solid #e6e9ee;
      padding:14px 20px;display:flex;
      align-items:center;justify-content:space-between;
    }

    .logo{font-weight:700;color:var(--primary);text-decoration:none}
    .btn{background:var(--primary);color:white;padding:8px 12px;border-radius:8px;border:0;cursor:pointer}
    .btn.ghost{background:transparent;color:var(--primary);border:1px solid var(--primary)}

    main{max-width:1100px;margin:28px auto;padding:0 18px}

    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px}
    .card{background:white;border-radius:10px;padding:16px;border:1px solid #e6e9ee;box-shadow:0 6px 18px rgba(16,24,40,0.03)}

    .course-image{
      height:170px;border-radius:8px;
      background:linear-gradient(135deg,#6e52ff,#ff6e8a);
      display:flex;align-items:center;justify-content:center;
      color:white;font-size:28px
    }

    .course-title{font-weight:700;font-size:18px;margin:12px 0 6px}
    .course-desc{color:var(--muted);font-size:14px;margin-bottom:12px}
    .price{font-weight:800;color:#059669;font-size:18px}

    footer{text-align:center;color:var(--muted);padding:20px;font-size:14px;margin-top:30px}

    /* Modal */
    .modal-back{
      position:fixed;inset:0;background:rgba(0,0,0,0.45);
      display:none;align-items:center;justify-content:center;
      z-index:2000;padding:16px
    }
    .modal-back.active{display:flex}

    .modal{
      width:100%;max-width:720px;background:white;
      border-radius:10px;padding:18px;
    }

    .row{display:flex;gap:12px}
    .qr{width:240px;height:240px;border-radius:8px;overflow:hidden;border:1px solid #ddd}

    @media (max-width:640px){
      .row{flex-direction:column}
    }
  </style>
</head>
<body>

<header>
  <a class="logo" href="#" onclick="showView('home')">Saeedi Courses</a>

  <div>
    <button class="btn" id="open-admin-btn">Admin Login</button>
    <button class="btn ghost" id="open-upload-btn">Upload Course</button>
  </div>
</header>

<main>

  <!-- HOME VIEW -->
  <section id="home-view">
    <h1>Courses</h1>
    <div class="small muted">Buy via UPI â€” Instant Access</div>

    <div id="courses-grid" class="grid"></div>
  </section>

  <!-- THANK YOU VIEW -->
  <section id="thankyou-view" class="hidden">
    <div class="card" style="text-align:center">
      <h2>Thank you ðŸŽ‰</h2>
      <p id="ty-text"></p>
      <a id="access-link" class="btn">Open Course</a>
      <br><br>
      <button class="btn ghost" onclick="showView('home')">Back</button>
    </div>
  </section>

  <!-- ACCESS VIEW -->
  <section id="access-view" class="hidden">
    <div class="card">
      <h2 id="access-title"></h2>
      <div class="small muted" id="access-desc"></div>

      <hr>

      <div id="access-content"></div>

      <br>
      <button class="btn ghost" onclick="showView('home')">Back</button>
    </div>
  </section>

  <!-- BUY MODAL -->
  <div class="modal-back" id="modal-buy">
    <div class="modal">

      <div style="display:flex;justify-content:space-between">
        <h3 id="buy-title">Buy</h3>
        <button onclick="closeModal('modal-buy')">Close</button>
      </div>

      <div class="row" style="margin-top:12px">
        <div style="flex:1">
          <p id="buy-desc"></p>
          <strong>Price:</strong> â‚¹<span id="buy-price">0</span>
          <br><br>
          <strong>UPI ID:</strong> <span id="upi-id">7078297357-3@ybl</span>

          <br><br>
          <button class="btn" id="open-upi-btn">Open UPI App</button>
          <button class="btn ghost" id="paid-btn">I Paid</button>
        </div>

        <div>
          <div class="small muted">Scan QR</div>
          <div class="qr">
            <img id="qr-img" src="/mnt/data/upi_qr.png" style="width:100%;height:100%;object-fit:cover">
          </div>
        </div>
      </div>

    </div>
  </div>

</main>

<footer>Â© 2025 Saeedi Courses</footer>

<script>
/* BASIC APP LOGIC */
const ADMIN_PASSWORD = "saeedi@7078";
const UPI_ID = "7078297357-3@ybl";

let courses = JSON.parse(localStorage.getItem("courses_v1") || "[]");
let purchases = JSON.parse(localStorage.getItem("purchases_v1") || "[]");

let adminLogged = false;
let currentBuy = null;

function saveCourses(){ localStorage.setItem("courses_v1", JSON.stringify(courses)); renderCourses(); }
function savePurchases(){ localStorage.setItem("purchases_v1", JSON.stringify(purchases)); }

function showView(v){
  document.querySelectorAll("main > section").forEach(s => s.classList.add("hidden"));
  document.getElementById(v + "-view").classList.remove("hidden");
}

function renderCourses(){
  const g = document.getElementById("courses-grid");
  if(courses.length === 0){
    g.innerHTML = "<div class='card'>No courses uploaded.</div>";
    return;
  }

  g.innerHTML = courses.map(c => `
    <div class="card">
      <div class="course-image">${c.title[0] || "C"}</div>
      <div class="course-title">${c.title}</div>
      <div class="course-desc">${c.desc}</div>

      <div style="display:flex;justify-content:space-between">
        <div class="price">â‚¹${c.price}</div>
        <button class="btn" onclick="openBuy('${c.id}')">Buy</button>
      </div>
    </div>
  `).join("");
}

renderCourses();

function openBuy(id){
  currentBuy = id;
  const c = courses.find(x => x.id === id);

  document.getElementById("buy-title").textContent = "Buy â€” " + c.title;
  document.getElementById("buy-desc").textContent = c.desc;
  document.getElementById("buy-price").textContent = c.price;
  document.getElementById("upi-id").textContent = UPI_ID;

  openModal("modal-buy");
}

function markAsPaid(){
  const c = courses.find(x => x.id === currentBuy);
  const pid = "p_" + Math.random().toString(36).slice(2,9);
  purchases.push({id: pid, courseId: c.id});
  savePurchases();

  closeModal("modal-buy");

  document.getElementById("ty-text").textContent = "Payment noted. Open your course below.";
  document.getElementById("access-link").onclick = ()=> openAccess(c.id);

  showView("thankyou");
}

document.getElementById("paid-btn").onclick = markAsPaid;

function openAccess(id){
  const c = courses.find(x => x.id === id);

  document.getElementById("access-title").textContent = c.title;
  document.getElementById("access-desc").textContent = c.desc;
  document.getElementById("access-content").innerHTML =
    `<a class="btn" href="${c.file}" target="_blank">Open File</a>`;

  showView("access");
}

function openModal(id){ document.getElementById(id).classList.add("active"); }
function closeModal(id){ document.getElementById(id).classList.remove("active"); }
</script>

</body>
</html>
